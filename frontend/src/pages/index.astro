---
import Layout from '../layouts/Layout.astro';
import Dashboard from '../components/dashboard/Dashboard';
import PerformanceSection from '../components/dashboard/PerformanceSection';
import Decisions from '../components/dashboard/Decisions';
import LiveStatus from '../components/dashboard/LiveStatus';
import { ExecutionViewer } from '../components/execution';
---

<Layout title="BrokeAgent - Dashboard">
	<div class="flex min-h-screen flex-col">
		<!-- Header -->
		<header class="sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
			<div class="container flex h-14 items-center px-4">
				<div class="flex items-center gap-2">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6">
						<path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
					</svg>
					<span class="font-bold text-lg">BrokeAgent</span>
				</div>
				<nav class="ml-8 flex items-center gap-6 text-sm">
					<a href="/" class="font-medium transition-colors hover:text-foreground/80 text-foreground">Dashboard</a>
					<a href="/workflows" class="font-medium transition-colors hover:text-foreground/80 text-muted-foreground">Workflows</a>
					<a href="/settings" class="font-medium transition-colors hover:text-foreground/80 text-muted-foreground">Settings</a>
				</nav>
				<div class="ml-auto flex items-center gap-4">
				<a
					href="http://localhost:3050/openapi"
					target="_blank"
					class="text-sm text-muted-foreground hover:text-foreground transition-colors"
				>
					API Docs
				</a>
				</div>
			</div>
		</header>

		<!-- Main Content -->
		<main class="flex-1 container px-4 py-8">
			<!-- Dashboard Section -->
			<section id="dashboard" class="mb-12">
				<h1 class="text-3xl font-bold mb-6">Portfolio Overview</h1>
				<Dashboard client:load />
			</section>

			<!-- P&L Chart Section -->
			<section id="performance" class="mb-12">
				<h2 class="text-2xl font-bold mb-6">Performance</h2>
				<PerformanceSection client:load />
			</section>

			<!-- Execution Viewer Section - New 3-panel layout -->
			<section id="executions" class="mb-12">
				<h2 class="text-2xl font-bold mb-6">Workflow Executions</h2>
				<ExecutionViewer client:load />
			</section>

			<!-- Decisions Section -->
			<section id="decisions" class="mb-12">
				<h2 class="text-2xl font-bold mb-6">Trading Decisions</h2>
				<Decisions client:load />
			</section>
		</main>

		<!-- Footer -->
		<footer class="border-t py-6 text-center text-sm text-muted-foreground">
			<div class="container">
				<p>BrokeAgent - AI-Powered Trading Simulation</p>
				<p class="mt-1">Built with Elysia, LangGraph, and Astro</p>
			</div>
		</footer>
	</div>
</Layout>
